name: 
Create or Update Release

on:
  push:
    branches:
      - main 

permissions:
  contenes: write
  actions: read

jobs:
  update-release:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Set up GitHub CLI
        uses: cli/gh-action@v2
        with:
          version: latest

      - name: Authenticate CLI
        run: echo "${{ secrets.GITHUB_TOKEN}}" | gh auth login --withtoken

      - name: Create or Update GitHub Release
        run: 
          TAG="v1.0.0"
          NAME="Release $TAG"
          BODY="–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–ª–∏–∑"

          if gh release view "$TAG" &>/dev/null; then
            echo "üîÑ Release $TAG —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –æ–±–Ω–æ–≤–∏–º –æ–ø–∏—Å–∞–Ω–∏–µ..."
            gh release edit "$TAG" --title "$NAME" --notes "$BODY"
          else
            echo "üöÄ –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—ã–π —Ä–µ–ª–∏–∑ $TAG..."
            gh release create "$TAG" --title "$NAME" --notes "$BODY"
          fi
        - name: Upload .deb packages
        run: |
          TAG="v1.0.0"
          for file in *.deb; do
            echo "‚¨ÜÔ∏è –ó–∞–≥—Ä—É–∂–∞–µ–º $file..."
            gh release upload "$TAG" "$file" --clobber
          done  


